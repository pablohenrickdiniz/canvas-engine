define(["AppObject","ImageLoader","Validator"],function(b,d,c){var a=function(f){var e=this;e.loads=[];e.url="";e.x=0;e.y=0;e.oldX=0;e.oldY=0;e.width=0;e.height=0;e.sx=0;e.sy=0;e.sWidth=0;e.sHeight=0;e.layer=0;e.loaded=false;e.image=null;e.parent=null;e.selected=false;a.bindProperties.apply(e);e.set(f)};a.prototype=new b();a.prototype.clone=function(){return new a(this.toJSON())};a.prototype.getBounds=function(){var e=this;return{x:e.x,y:e.y,width:e.width,height:e.height}};a.bindProperties=function(){var e=this;e._beforeSet("x",c.validateNumber);e._beforeSet("y",c.validateNumber);e._beforeSet("width",c.validateNumber);e._beforeSet("height",c.validateNumber);e._beforeSet("sx",c.validateNumber);e._beforeSet("sy",c.validateNumber);e._beforeSet("sWidth",c.validateNumber);e._beforeSet("sHeight",c.validateNumber);e._beforeSet("layer",c.validateNumber);e._beforeSet("url",b.isString);e.onChange("url",function(f){e.loaded=false;e.image=new Image();d.load(f,function(g){e.loaded=true;e.image=g})})};a.prototype.toJSON=function(){var e=this;return{url:e.url,x:e.x,y:e.y,width:e.width,height:e.height,sx:e.sx,sy:e.sy,sWidth:e.sWidth,sHeight:e.sHeight,layer:e.layer}};a.prototype.isLoaded=function(){return this.loaded};a.prototype.isTransparent=function(e,j){var g=this;if(g.image!==null&&e<g.width&&j<g.height&&e>=0&&j>=0){var h=document.createElement("canvas");h.width=1;h.height=1;var f=h.getContext("2d");f.drawImage(g.image,g.sx+e,g.sy+j,1,1,0,0,1,1);var i=f.getImageData(0,0,1,1).data;return i[3]===undefined||i[3]===0}return true};return a});