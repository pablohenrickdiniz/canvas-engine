define(["AppObject","FrameSync","Validator","Frame"],function(a,d,c,b){var e=function(g){var f=this;f.speed=3;f.repeat=false;f.running=false;f.frames=[];f.indexFrame=-1;f.x=0;f.y=0;f.width=32;f.height=32;f.frameInterval=null;f.frameSync=null;f.canvasLayer=null;f.onStepCall=null;a.call(f);e.bindProperties.apply(f);f.set(g)};e.prototype=Object.create(a.prototype);e.prototype.constructor=e;e.bindProperties=function(){var f=this;f._beforeSet("speed",c.validateInt);f._beforeSet("repeat",c.validateBoolean);f._beforeSet("frames",c.validateArray);f._beforeSet("indexFrame",c.validateInt);f._beforeSet("x",c.validateNumber);f._beforeSet("y",c.validateNumber);f._beforeSet("width",c.validateNumber);f._beforeSet("height",c.validateNumber);f._accessible(["speed","repeat","frames","x","y","width","height"])};e.prototype.execute=function(){var f=this;if(!f.running){f.running=true;f.step()}};e.prototype.onStep=function(f){this.onStepCall=f};e.prototype.setSpeed=function(f){this.speed=f};e.prototype.getSpeed=function(){return this.speed};e.prototype.step=function(){var f=this;if(f.running){f.frameInterval=setTimeout(function(){f.frameSync=d(function(){f.step()});if(f.indexFrame>=f.frames.length-1){f.indexFrame=0}else{f.indexFrame=f.indexFrame+1}if(f.canvasLayer!==null){f.canvasLayer.drawAnimation(f)}if(f.onStepCall!==null){f.onStepCall(f.indexFrame)}},1000/(f.speed))}};e.prototype.pause=function(){var f=this;f.running=false;clearInterval(f.frameInterval);window.cancelAnimationFrame(f.frameSync);return f};e.prototype.add=function(g){var f=this;if(g instanceof b){g.parent=f;f.frames.push(g)}return f};e.prototype.get=function(g){var f=this;if(f.frames[g]!==undefined){return f.frames[g]}return null};e.prototype.set=function(g,h){var f=this;if(f.frames[g]!==undefined){f.frames[g]=h}return f};e.prototype.swap=function(i,h){var g=this;if(g.frames[i]!==undefined&&g.frames[h]!==undefined){var f=g.frames[i];g.frames[i]=g.frames[h];g.frames[h]=f}return g};e.prototype.remove=function(h){var f=this;var g=-1;if(h instanceof b){g=f.frames.indexOf(h)}else{if(c.isInt(h)&&f.frames[h]!==undefined){g=h}}if(g!==-1){f.frames.splice(g,1)}return f};e.prototype.clearFrames=function(){var f=this;f.frames=[];return f};e.prototype.stop=function(){var f=this;f.pause();f.indexFrame=-1;return f};e.prototype.isRunning=function(){return this.running};return e});