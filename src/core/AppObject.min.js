define(["lodash"],function(b){var a=function(){var c=this;c._changeCallbacks=[];c._bfrSet=[];c._changed=[];c._aftChange=[]};a.prototype.set=function(d){var c=this;if(d instanceof Object){Object.keys(c).forEach(function(f){if(d[f]!==undefined){var g=d[f];var e=c[f];if(!b.isEqual(e,g)){if(c._bfrSet[f]!==undefined){g=c._bfrSet[f](e,g)}if(!b.isEqual(e,g)){c[f]=g;c._changed[f]=true;if(c._changeCallbacks[f]!==undefined){c._changeCallbacks[f](g)}}}}});if(c._aftChange.length>0&&Object.keys(c._changed).length>0){c._aftChange.forEach(function(e){e()})}c._changed=[]}return c};a.prototype._afterChange=function(c){this._aftChange.push(c)};a.prototype._isChanged=function(d){var c=this;return c._changed[d]!==undefined};a.prototype._beforeSet=function(d,e){var c=this;if(c[d]!==undefined||c[d]===null){c._bfrSet[d]=e}return c};a.prototype._onChange=function(d,e){var c=this;if(c[d]!==undefined||c[d]===null){c._changeCallbacks[d]=e}return c};a.prototype._unbindChange=function(d){var c=this;if(c._changeCallbacks[d]!==undefined){delete c._changeCallbacks[d]}};a.prototype.props=function(){return Object.keys(this)};return a});